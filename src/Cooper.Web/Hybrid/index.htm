<!DOCTYPE html>
<html>
<head>
    <title>Cooper:Task</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="themes/cooper.css" rel="stylesheet" type="text/css" />
    <link href="jquery/css/mobile/jquery.mobile.structure-1.1.1.min.css" rel="stylesheet" type="text/css" />
    <link href="css/base.css" rel="stylesheet" type="text/css" />
</head>
<body>

    <script src="scripts/cooper.js" type="text/javascript"></script>
    <script src="scripts/lang.js" type="text/javascript"></script>
<!--    <script src="jquery/jqm.page.params.js" type="text/javascript"></script>-->

    <!--全局-->
    <script type="text/javascript">

    </script>

    <!-- 登录面板 -->
    <div id="loginPanel" data-role="page" data-theme="a">
        <div data-role="content">
            <div style="text-align: center;">
                <img src="images/cooper.png" width="250px" />
            </div>
            <form>
            <ul data-role="listview" data-inset="true">
                <li data-role="fieldcontain">
                    <input type="text" placeholder="账号" name="username" style="width: 100%" />
                </li>
                <li data-role="fieldcontain">
                    <input type="password" placeholder="密码" name="password" style="width: 100%" />
                </li>
            </ul>
            <div class="ui-grid-a">
                <div class="ui-block-a">
                    <div data-role="controlgroup">
                        <input type="checkbox" name="record" id="record" checked="checked" />
                        <label for="record">
                            记住登录</label>
                    </div>
                </div>
                <div class="ui-block-b" style="text-align: right">
                    <button id="loginButton" type="button" data-inline="true" data-theme="a">
                        登录</button>
                    <button type="button" data-inline="true">
                        跳过</button>
                </div>
            </div>
            </form>
        </div>
    </div>
    <!-- 任务列表面板 -->
    <div id="taskListPanel" data-role="page" data-theme="a">
        <div data-role="header">
            <div class="ui-btn-left" style="line-height: 50px">
                <img id="addTaskListImg" src="images/edit.png" />
                &nbsp;
                <img id="refreshTaskListsImg" src="images/refresh.png" />
            </div>
            <h1>
                cooper:task</h1>
            <div class="ui-btn-right"><img src="images/setting.png" /></div>
        </div>
        <div data-role="content">
            <ul id="taskListUl" data-role="listview" data-inset="true" data-icon="star" data-theme="c"></ul>
        </div>
    </div>
    <!-- 任务面板 -->
    <div id="taskPanel" data-role="page" data-theme="a">
        <div data-role="header" data-position="fixed">
            <div class="ui-btn-left" style="line-height: 50px">
                <img id="gotoTasklistImg" src="images/tasklist.png" />
                &nbsp;
                <img id="refreshTasksImg" src="images/refresh.png" />
            </div>
            <h1>
                cooper:task</h1>
            <div class="ui-btn-right" style="line-height: 50px">
                <img id="addTaskImg" src="images/edit.png" /></div>
        </div>
        <div data-role="content">
            <ul id="taskUl" data-role="listview" data-theme="c"></ul>
        </div>
        <div data-role="footer" data-position="fixed" data-theme="a">
            <div data-role="navbar">
                <ul>
                    <li><a>
                        <img src="images/task.png" />
                        <br />
                        个人任务</a></li>
                    <li><a>
                        <img src="images/complete.png" />
                        <br />
                        已完成</a></li>
                    <li><a>
                        <img src="images/incomplete.png" />
                        <br />
                        未完成</a></li>
                    <li><a>
                        <img src="images/setting-small.png" />
                        <br />
                        设置</a></li>
                </ul>
            </div>
        </div>
    </div>
    <!-- 任务详情面板 -->
    <div id="taskDetailPanel" data-role="page">
        <div data-role="header" data-position="fixed">
            <div class="ui-btn-left" style="line-height: 50px">
                <img id="gotoTaskPanel" src="images/back.png" />
            </div>
            <h1>
                cooper:task</h1>
            <div class="ui-btn-right" style="line-height: 50px">
                <img id="gotoTaskEditPanel" src="images/edit.png" /></div>
        </div>
        <div data-role="content" style="background-color: #fff">
            <div data-role="fieldcontain">
                <label for="complete">
                    是否完成</label>
                <select name="complete" id="complete" data-role="slider">
                    <option value="false">未完成</option>
                    <option value="true">完成</option>
                </select>
            </div>
            <div data-role="fieldcontain">
                <fieldset data-role="controlgroup" data-type="horizontal">
                    <legend>优先级</legend>
                    <input type="radio" name="level" id="radio-level-1" value="0" />
                    <label for="radio-level-1">
                        今天</label>
                    <input type="radio" name="level" id="radio-level-2" value="1" />
                    <label for="radio-level-2">
                        稍后</label>
                    <input type="radio" name="level" id="radio-level-3" value="2" />
                    <label for="radio-level-3">
                        迟些</label>
                </fieldset>
            </div>
            <div data-role="fieldcontain">
                <label for="duetime2">
                    截止日期</label>
                <input type="date" name="duetime2" id="duetime2" />
            </div>
            <div data-role="fieldcontain">
                <input type="hidden" id="taskId2" value="" />
                <p id="subject2"></p>
                <p id="body2"></p>
            </div>
            <br />
            <ul data-role="listview" data-icon="star" data-inset="true">
                <li>
                    <h3>
                    </h3>
                    <p>
                        <strong>wsky 评论于 2012-7-8</strong></p>
                    <p>
                        Hey Stephen, if you're available at 10am tomorrow, we've got a meeting with the
                        jQuery team.
                    </p>
                </li>
                <li>
                    <h3>
                    </h3>
                    <p>
                        <strong>wsky 评论于 2012-7-8</strong></p>
                    <p>
                        Hey Stephen, if you're available at 10am tomorrow, we've got a meeting with the
                        jQuery team.
                    </p>
                </li>
                <li>
                    <h3>
                    </h3>
                    <p>
                        <strong>wsky 评论于 2012-7-8</strong></p>
                    <p>
                        Hey Stephen, if you're available at 10am tomorrow, we've got a meeting with the
                        jQuery team.
                    </p>
                </li>
            </ul>
        </div>
        <div data-role="footer" data-position="fixed" data-theme="a">
            <input type="text" placeholder="添加评论" />
        </div>
    </div>
    <!-- 任务新增编辑面板 -->
    <div id="taskEditPanel" data-role="page">
        <div data-role="header" data-position="fixed">
            <div class="ui-btn-left" style="line-height: 50px">
                <img id="gotoTaskDetailPanel" src="images/back.png" />
            </div>
            <h1>
                cooper:task</h1>
            <a id="addOrUpdateTaskButton" class="ui-btn-right" data-icon="check">确定</a>
        </div>
        <div data-role="content" style="background-color: #fff">
            <input type="hidden" id="taskId" value="" />
            <div data-role="fieldcontain">
                <label for="isCompleted">
                    是否完成</label>
                <select name="isCompleted" id="isCompleted" data-role="slider">
                    <option value="false">未完成</option>
                    <option value="true">完成</option>
                </select>
            </div>
            <div data-role="fieldcontain">
                <fieldset data-role="controlgroup" data-type="horizontal">
                    <legend>优先级</legend>
                    <input type="radio" name="priority" id="radio-choice-1" value="0" />
                    <label for="radio-choice-1">
                        今天</label>
                    <input type="radio" name="priority" id="radio-choice-2" value="1" />
                    <label for="radio-choice-2">
                        稍后</label>
                    <input type="radio" name="priority" id="radio-choice-3" value="2" />
                    <label for="radio-choice-3">
                        迟些</label>
                </fieldset>
            </div>
            <div data-role="fieldcontain">
                <label for="duetime">
                    截止日期</label>
                <input type="date" name="duetimeForEdit" id="duetimeForEdit" />
            </div>
            <div data-role="fieldcontain">
                <label for="subject">
                    标题</label>
                <input name="subject" id="subject" type="text" placeholder="标题" />
            </div>
            <div data-role="fieldcontain">
                <label for="body">
                    备注</label>
                <textarea placeholder="备注" name="body" id="body" style="height: 200px"></textarea>
            </div>
        </div>
    </div>
    <!-- 新增任务列表 -->
    <div id="addTaskListPanel" data-role="page" data-theme="a">
        <div data-role="content">
            <form>
            <ul data-role="listview" data-inset="true">
                <li data-role="fieldcontain">
                    <input type="text" placeholder="列表名称" id="tasklistName" name="tasklistName" style="width: 100%" />
                </li>
            </ul>
            <div class="ui-block-b">
                <button id="saveNewTaskList" type="button" data-inline="true" data-theme="a">
                    保存</button>
                <button id="cancelAddTaskList" type="button" data-inline="true" data-theme="a">
                    取消</button>
            </div>
            </form>
        </div>
    </div>

    <script src="jquery/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script src="jquery/jquery.mobile-1.1.0.min.js" type="text/javascript"></script>

    <script type="text/javascript">
        $(function () {

            //            var pageData = {};
            //            $(document).bind("mobileinit", function () {
            //                $.mobile.page.prototype.options.domCache = true;
            //            });
            //            $(document).bind("pagebeforechange", function (e, data) {
            //                //console.log(data);
            //                //jqm.page.params填充此数据
            //                pageData = data.options.pageData;
            //            });

            //登录
            $('#loginButton').click(function () {
                var userName = $("#username").val();
                var password = $("#password").val();
                login(userName, password);
            });

            //返回任务列表面板
            $('#gotoTasklistImg').click(function () {
                showTaskListPanel();
            });

            //新增任务列表
            $('#addTaskListImg').click(function () {
                showAddTaskListPanel();
            });
            //刷新任务列表面板
            $('#refreshTaskListsImg').click(function () {
                refreshTaskListPanel();
            });

            //返回任务面板
            $('#gotoTaskPanel').click(function () {
                showTaskPanel(getCurrentTaskListId());
            });
            //重定向到任务编辑面板
            $('#gotoTaskEditPanel').click(function () {
                showTaskEditPanelAuto();
            });

            //重定向到任务详情面板
            $('#gotoTaskDetailPanel').click(function () {
                showTaskDetailPanelAuto();
            });

            //显示新增编辑任务面板
            $('#addTaskImg').click(function () {
                showTaskEditPanel("");
            });
            //刷新任务面板
            $('#refreshTasksImg').click(function () {
                refreshTaskPanel();
            });

            //新增任务列表确定按钮响应函数
            $('#saveNewTaskList').click(function () {
                var taskListName = $("#tasklistName").val();
                addTaskList(taskListName);
            });
            //新增任务列表取消按钮响应函数
            $('#cancelAddTaskList').click(function () {
                showPanel("taskListPanel");
            });
            //新增编辑任务确定按钮响应函数
            $('#addOrUpdateTaskButton').click(function () {
                var id = $("#taskId").val();
                var subject = $("#subject").val();
                var body = $("#body").val();
                var selectedPriority = $("input[name='priority']:checked");
                var priority = selectedPriority != null ? selectedPriority.val() : 0;
                var dueTime = $("#duetimeForEdit").val();
                var isCompleted = $("#isCompleted").val();

                //alert(id + '|' + subject + '|' + body + '|' + priority + '|' + dueTime + '|' + isCompleted);
                addOrUpdateTask(id, subject, body, priority, dueTime, isCompleted);
            });

            $(document).bind("pagebeforechange", onbeforepagechange);
            //$(document).delegate("#taskPanel", "pageinit", function () {
            //    alert('task panel page inited.');
            //});

            //$(document).delegate("#taskPanel", "pageinit", initializeTaskPanel);
            //$(document).delegate("#taskPanel", "pageshow", initializeTaskPanel);
        });
    </script>

</body>
</html>
